# Скальпинг-робот для Tinkoff Invest API

Это многофункциональный торговый робот для скальпинга на Московской бирже с использованием Tinkoff Invest API. Он автоматически выбирает наиболее волатильные инструменты, применяет адаптивные стратегии и управляется через Telegram-бот.

**ВНИМАНИЕ**: Использование данного кода на реальных счетах сопряжено с высоким риском потери денежных средств. Автор не несет ответственности за ваши торговые решения. Всегда тестируйте робота в режиме "песочницы" (`USE_SANDBOX = True`).

## Основные возможности

- **Интеграция с Tinkoff Invest API**: Работа как с реальным счетом, так и с "песочницей".
- **Динамический выбор инструментов**: Ежедневно определяет 10 самых волатильных акций на основе ATR.
- **Адаптивные стратегии**: Автоматически переключается между трендовой стратегией (пересечение MA) и стратегией для боковика (Ленты Боллинджера + RSI) на основе индикатора ADX.
- **Управление рисками**: Рассчитывает размер позиции на основе заданного риска, автоматически выставляет Stop Loss и Take Profit.
- **Управление через Telegram**: Запуск, остановка и получение статуса робота через команды в Telegram-боте.
- **Подробные уведомления**: Отправляет в Telegram информацию о запуске, выборе инструментов и каждой сделке.
- **Надежность**: Реализованы механизмы повторных попыток при сбоях API и подробное логирование ошибок.

## Установка

1.  **Клонируйте репозиторий**:
    ```bash
    git clone <адрес_репозитория>
    cd <имя_папки>
    ```

2.  **Создайте и активируйте виртуальное окружение** (рекомендуется):
    ```bash
    python -m venv venv
    source venv/bin/activate  # Для Windows: venv\Scripts\activate
    ```

3.  **Установите зависимости**:
    ```bash
    pip install -r requirements.txt
    ```

4.  **Настройте переменные окружения**:
    -   Переименуйте файл `.env.example` в `.env`.
    -   Откройте `.env` и вставьте ваши ключи и ID:
        -   `TINKOFF_API_TOKEN`: Токен для Tinkoff Invest API с полным доступом. [Как получить токен?](https://tinkoff.github.io/investAPI/token/)
        -   `TELEGRAM_BOT_TOKEN`: Токен вашего Telegram-бота. Создается через `@BotFather`.
        -   `TELEGRAM_CHAT_ID`: Ваш личный ID в Telegram. Узнать можно у бота `@userinfobot`.
        -   `TINKOFF_ACCOUNT_ID`: ID вашего счета. Его можно найти в личном кабинете или получить через API.

5.  **Настройте параметры робота** (опционально):
    -   Откройте файл `config.py`.
    -   Установите `USE_SANDBOX = True` для тестирования в песочнице или `False` для реальной торговли.
    -   При необходимости измените параметры стратегий, управления рисками и т.д.

## Запуск

Для запуска робота выполните команду в терминале:

```bash
python main.py
